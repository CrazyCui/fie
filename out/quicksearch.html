<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"fie-core_lib_api.js.html":{"id":"fie-core_lib_api.js.html","title":"Source: fie-core/lib/api.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/lib/api.js /** * @desc fie对 所有套件和插件 选择性透出的数据/API 都在这里, 这里的透出应该是不因为套件或插件不同而改变 * @author 六韬 &lt;yubhbh@gmail.com&gt; */ 'use strict'; const open = require('open'); const inquirer = require('inquirer'); const co = require('co'); const fieLog = require('fie-log'); const fieModule = require('fie-module'); const home = require('fie-home'); const config = require('fie-config'); const npm = require('fie-npm'); const report = require('fie-report'); const fs = require('fie-fs'); const argv = require('yargs').argv; const extendConfig = {}; const apiList = { /** * 是否在控制台调用 * @param {string} currentModuleName 如 @ali@fie-plugin-git,@ali@fie-toolkit-next * @returns {boolean} */ isCallByConsole(currentModule) { return this.moduleName === fieModule.fullName(currentModule); }, getFieModule(name, cb) { return new Promise((resolve, reject) =&gt; { co(function* () { const moduleInfo = yield fieModule.get(name); typeof cb === 'function' &amp;&amp; cb(null, moduleInfo.mod, moduleInfo.options); resolve(moduleInfo); }).catch((err) =&gt; { reject(err); }); }); }, tnpmInstall(options, cb) { return new Promise((resolve, reject) =&gt; { co(function* () { if (typeof options === 'function') { cb = options; options = {}; } if (options.name) { yield npm.install(options.name, options); } else { yield npm.installDependencies(options); } typeof cb === 'function' &amp;&amp; cb(null); resolve(); }).catch(err =&gt; reject(err)); }); }, getModuleConfig(key) { key = key || 'toolkitConfig'; return Object.assign({}, argv, config.get(key)); }, setModuleConfig: config.set, dirCopy: fs.copyDirectory, fileCopy: fs.copyTpl, fileRewrite: fs.rewriteFile, getFieModulesPath: home.getModulesPath, report, open, inquirer }; module.exports = { getApi(moduleName, moreApi) { // API透出前预处理 moduleName = moduleName &amp;&amp; fieModule.fullName(moduleName); moduleName = moduleName || 'fie-core'; const log = fieLog(moduleName); apiList.logInfo = log.info; apiList.logError = log.warn; apiList.logSuccess = log.success; apiList.logDebug = log.debug; return apiList; } }; × Search results Close "},"fie-cache_lib_index.js.html":{"id":"fie-cache_lib_index.js.html","title":"Source: fie-cache/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-cache/lib/index.js /** * @desc 缓存模块 * @see http://fie.alibaba.net/doc?package=fie-cache * @author 擎空 &lt;zernmal@foxmail.com&gt; * @namespace fie-cache */ 'use strict'; const fs = require('fs-extra'); const path = require('path'); const home = require('fie-home'); const cacheFile = path.resolve(home.getHomePath(), 'cache.json'); /** * @exports fie-cache */ module.exports = { /** * 获取缓存内容,如果不存在或已过期则返回 null * @param {string} key 缓存的键 * @returns {mix} */ get(key) { if (!key || !fs.existsSync(cacheFile)) { return null; } const data = fs.readJsonSync(cacheFile); // 有效期判断 if (data.__expries &amp;&amp; data.__expries[key] &lt; Date.now()) { return null; } return data[key]; }, /** * 设置缓存内容 * @param key {string} 缓存的键 * @param value {mix} 缓存的值 * @param options {object} * @param options.expries {number} 有效时长,毫秒为单位, 如 1分钟为 360000 * @returns {boolean} */ set(key, value, options) { if (!key) { return false; } options = Object.assign({}, { expries: null }, options); let data = {}; if (fs.existsSync(cacheFile)) { data = fs.readJsonSync(cacheFile); } // 有效期处理 data.__expries = data.__expries || {}; if (options.expries) { data.__expries[key] = Date.now() + options.expries; } else { data.__expries[key] = null; } data[key] = value; fs.outputJsonSync(cacheFile, data); return true; } }; × Search results Close "},"fie-config_lib_index.js.html":{"id":"fie-config_lib_index.js.html","title":"Source: fie-config/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-config/lib/index.js /** * @desc fie配置文件(fie.config.js)读写等操作 * @see ttp://fie.alibaba.net/doc?package=fie-config * @namespace fie-config */ 'use strict'; const path = require('path'); const fs = require('fs-extra'); const debug = require('debug')('fie-config'); const astAnalyze = require('./ast-analyze'); // fie配置文件 const CONFIG_FILE = 'fie.config.js'; const CWD = process.cwd(); const fieConfig = { /** * 当前目录下是否存在fie.config.js文件 * @param {string} dir 需要判断文件是否存在的目录,可选,默认取值: */ exist(dir) { const cwd = dir || CWD; const fieConfigPath = path.join(cwd, CONFIG_FILE); return fs.existsSync(fieConfigPath); }, /** * 根据key获取fie.config.js的单个对象 * @param key * @return object */ get(key, dir) { const cwd = dir || CWD; const file = this.getAll(cwd); debug('key = %s ,all config = %o', key, file); return file ? file[key] : null; }, /** * 获取整个fie.config.js文件的内容 */ getAll(dir) { const cwd = dir || CWD; // 先判断文件是否存在,存在的话才读取 if (!this.exist(cwd)) { return null; } // 直接使用require的话,会有缓存， 需要先删除 require 的缓存 const configPath = path.join(cwd, CONFIG_FILE); delete require.cache[configPath]; const file = require(configPath); debug('get %s , file = %o', CONFIG_FILE, file); return file; }, /** * 设置fie.config.js的属性值,写入相关内容 * @param key fie.config.js中的key * @param value key对应的value */ set(key, value, dir) { const cwd = dir || CWD; const filePath = path.join(cwd, CONFIG_FILE); // 读取文件 const code = fs.readFileSync(filePath, 'utf8'); const source = astAnalyze(code, key, value); debug('set %s file source string = %o', CONFIG_FILE, source); fs.writeFileSync(filePath, source); return true; }, /** * 获取套件的名字 */ getToolkitName(dir) { const cwd = dir || CWD; const config = this.getAll(cwd); if (!config) { return null; } if (config.toolkit) { return config.toolkit; } else if (config.toolkitName) { return config.toolkitName; } return null; } }; /** * @exports fie-config */ module.exports = fieConfig; × Search results Close "},"fie-env_lib_index.js.html":{"id":"fie-env_lib_index.js.html","title":"Source: fie-env/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-env/lib/index.js 'use strict'; /** * @desc FIE的内外网环境获取与设置 * @requires fie-env * @author 宇果 &lt;baofen14787@gmail.com&gt; * @namespace fie-env */ const debug = require('debug')('fie-env'); const home = require('fie-home'); const fs = require('fs-extra'); const path = require('path'); // fie env的配置文件 const FILE_ENV = 'fie.env.json'; let cacheEnv = null; /** * 设置FIE的运行环境,设置成功后写入到FILE_ENV文件里 * @param {('extranet'|'intranet')} env - 内外网环境变量,枚举可选的值有:extranet / intranet * @private */ function setEnv(env) { home.initHomeDir(); const envFile = path.join(home.getHomePath(), FILE_ENV); const envData = { env }; debug('set fie env data : %o',envData); debug('set fie to : %s',envFile); cacheEnv = null; fs.outputJsonSync(envFile, envData); } /** * @exports fie-env */ module.exports = { /** * 设置FIE的运行环境,设置成功后写入到FILE_ENV文件里 * @param {('extranet'|'intranet')} env - 内外网环境变量,枚举可选的值有:extranet / intranet */ setEnv, /** * 设置FIE的运行环境为外网环境 */ setExtranetEnv() { setEnv('extranet'); }, /** * 设置FIE的运行环境为内网环境 */ setIntranetEnv() { setEnv('intranet'); }, /** * 是否是内网环境 * 优先判断process.env.FIE_ENV变量,值为intranet,则返回true * @returns {boolean} 若是公司内网,则返回true,否则为false */ isIntranet() { // 如果有环境变量,则优先使用环境变量的值 const fieEnvGlobal = process.env.FIE_ENV; if (fieEnvGlobal &amp;&amp; fieEnvGlobal === 'intranet') { return true; } else if (fieEnvGlobal &amp;&amp; fieEnvGlobal === 'extranet') { return false; } // 内外网判断 // 由于该方法调用频繁,在这里使用一个cacheEnv对象做为缓存,避免频繁的IO操作 let envData; if (cacheEnv) { envData = cacheEnv; } else { const envFile = path.join(home.getHomePath(), FILE_ENV); if (fs.existsSync(envFile)) { envData = fs.readJsonSync(envFile); cacheEnv = envData; } } // 注意: 若json文件不存在时,默认视为内网环境,向下兼容 return !(envData &amp;&amp; envData.env === 'extranet'); }, /** * 判断FIE环境配置文件(fie.env.json)是否存在 * 可用做FIE环境是否已初始化的判断 * @returns {boolean} */ hasConfigFile() { const envFile = path.join(home.getHomePath(), FILE_ENV); return fs.existsSync(envFile); }, /** * 删除FIE环境配置文件(fie.env.json) */ removeConfigFile() { fs.removeSync(path.join(home.getHomePath(), FILE_ENV)); cacheEnv = null; } }; × Search results Close "},"fie-error_lib_index.js.html":{"id":"fie-error_lib_index.js.html","title":"Source: fie-error/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/index.js /** * @desc 异常处理中心,扑获常见的异常 并人性化展示 * @requires fie-error/handle * @requires fie-error/register * @author 擎空 &lt;zernmal@foxmail.com&gt; * @namespace fie-error */ 'use strict'; const handle = require('./handle'); const register = require('./register'); module.exports = { handle, register }; × Search results Close "},"fie-error_lib_handle.js.html":{"id":"fie-error_lib_handle.js.html","title":"Source: fie-error/lib/handle.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/handle.js /** * @desc 错误处理,先会调用之前注册过的错误处理,最后执行默认的处理 * @author 擎空 &lt;zernmal@foxmail.com&gt; * @memberOf fie-error * @namespace handle * @exports handle */ 'use strict'; const co = require('co'); const log = require('fie-log')('fie-error'); const utils = require('./utils'); const innerList = [ require('./handle-module-not-found'), require('./handle-enoent'), require('./handle-default') ]; /** * 注册错误处理器 * @param {error} e 错误对象 */ function handle(e) { co(function* () { log.debug('error code = %s', e.code); const handList = utils.getHandleList().concat(innerList); for (let i = 0; i &lt; handList.length; i += 1) { const res = yield handList[i](e); if (res === true) { // 说明错误已被处理, 可以直接返回了 return; } } }).catch((e) =&gt; { console.log(e); }); } module.exports = handle; × Search results Close "},"fie-error_lib_register.js.html":{"id":"fie-error_lib_register.js.html","title":"Source: fie-error/lib/register.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/register.js /** * @desc 注册错误处理器 * @author 擎空 &lt;zernmal@foxmail.com&gt; * @memberOf fie-error * @namespace register * @exports register */ 'use strict'; const utils = require('./utils'); /** * 注册错误处理器 * @param {generatorFunction|Array} handle 错误处理器, 必须是 generator函数, 多个时可以传数组, * 进程报错时传入错误对象并依次调用, * 如果 catch 到错误并处理完请返回 true, 否则将继续往下执行其他处理器函数 */ function register(handle) { if (Array.isArray(handle)) { handle.forEach((item) =&gt; { utils.register(item); }); } else { utils.register(handle); } } module.exports = register; × Search results Close "},"fie-fs_lib_index.js.html":{"id":"fie-fs_lib_index.js.html","title":"Source: fie-fs/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-fs/lib/index.js /** * @desc 汇集文件操作的基本方法 * @see http://fie.alibaba.net/doc?package=fie-fs * @requires fie-fs/copy-director * @requires fie-fs/copy-tpl * @requires fie-fs/rewrite-fie * @requires fie-fs/remove * @requires fie-fs/move * @author 擎空 &lt;zernmal@foxmail.com&gt; * @namespace fie-fs */ 'use strict'; module.exports = { copyDirectory: require('./copy-directory'), copyTpl: require('./copy-tpl'), rewriteFile: require('./rewrite-file'), remove: require('./remove'), move: require('./move') }; × Search results Close "},"fie-task_lib_index.js.html":{"id":"fie-task_lib_index.js.html","title":"Source: fie-task/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-task/lib/index.js /** * @desc 汇集系统操作基本方法 * @see http://fie.alibaba.net/doc?package=fie-home * @requires fie-task/run * @requires fie-task/funFunction * @author 擎空 &lt;qingkong@alibaba-inc.com&gt; * @namespace fie-fs */ 'use strict'; module.exports = { run: require('./run'), runFunction: require('./run-function'), has: require('./has') }; × Search results Close "},"fie-fs_lib_copy-directory.js.html":{"id":"fie-fs_lib_copy-directory.js.html","title":"Source: fie-fs/lib/copy-directory.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-fs/lib/copy-directory.js /** * @desc copy file * @see http://fie.alibaba.net/doc?package=fie-home * @requires @ali/fie-logger * @requires underscore * @author 擎空 &lt;qingkong@alibaba-inc.com&gt; * @namespace copy-directory * @memberOf fie-fs * @exports copy-directory */ 'use strict'; const fs = require('fs-extra'); const path = require('path'); const _ = require('underscore'); const utils = require('./utils'); const log = require('fie-log')('fie-fs'); _.templateSettings = utils.templateSettings; /** * 复制目录 * 支持 underscore 模板引擎, 标签开始和结束符是: &lt;{% %}&gt; * @param {object} options * @param {string} options.src 绝对路径 * @param {string} options.dist 绝对路径 * @param {string} options.data * @param {array} options.ignore 数组, 类似 gitignore 的写法 * @example * options.src 绝对路径 * options.dist 绝对路径 * options.data * options.ignore 数组, 类似 gitignore 的写法 * options.stringReplace 数组 , 将文件里面匹配到的字符串替换掉,如 [ { placeholder: 'PLACEHOLDER', value: 'theReplaceValue' } ] * options.filenameTransformer 函数, 文件名转换函数列表 * options.templateSettings 详细使用请查看 underscore 的templateSettings, 默认为: { * evaluate: /&lt;{%([\\s\\S]+?)%}&gt;/g, * interpolate: /&lt;{%=([\\s\\S]+?)%}&gt;/g, * escape: /&lt;{%-([\\s\\S]+?)%}&gt;/g } * options.encoding 默认 utf-8 */ function copyDirectory(options) { // 递归读取目录 const recursiveDir = (curSrcPath, curDistPath) =&gt; { const stats = fs.statSync(curSrcPath); if (stats.isDirectory()) { // 若目标目录不存在, 会创建一个 fs.mkdirsSync(curDistPath); const dirFiles = fs.readdirSync(curSrcPath); for (let i = 0; i &lt; dirFiles.length; i += 1) { if (options.ignore.indexOf(dirFiles[i]) === -1) { recursiveDir(path.resolve(curSrcPath, dirFiles[i]), path.resolve(curDistPath, dirFiles[i])); } } } else { curDistPath = curDistPath.split(path.sep); // 文件名转换 const newFilename = options.filenameTransformer(curDistPath.pop()); if (!newFilename) { return log.error(`${curDistPath.join(path.sep)} 文件名转换失败, 返回为空`); } curDistPath = path.resolve(curDistPath.join(path.sep), newFilename); // 文件内容变量替换 let fileContent = fs.readFileSync(curSrcPath, { encoding: options.encoding }).toString(); fileContent = _.template(fileContent)(options.data); for (let j = 0; j &lt; options.stringReplace.length; j += 1) { fileContent = fileContent.replace(new RegExp(options.stringReplace[j].placeholder, 'g'), options.stringReplace[j].value); } const writeErr = fs.writeFileSync(curDistPath, fileContent); if (!writeErr) { log.success(`${curDistPath} 写入成功`); } else { log.error(`${curDistPath} 写入出错`); } } }; options = options || {}; if (!options.src || !options.dist) { log.error('请传入源文件目录路径 和 目标目录路径'); return; } if (!fs.existsSync(options.src)) { log.error('源文件目录不存在'); return; } options.data = options.data || {}; options.ignore = options.ignore || ['node_modules', '.DS_Store', '.idea']; options.stringReplace = options.stringReplace || []; options.filenameTransformer = options.filenameTransformer || (a =&gt; a); // 开发者可以自定义模板标签类型 if (options.templateSettings) { _.templateSettings = _.extend(_.templateSettings, options.templateSettings); } recursiveDir(options.src, options.dist); } module.exports = copyDirectory; × Search results Close "},"fie-fs_lib_copy-tpl.js.html":{"id":"fie-fs_lib_copy-tpl.js.html","title":"Source: fie-fs/lib/copy-tpl.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-fs/lib/copy-tpl.js /** * @desc 复制文件 * @author 擎空 &lt;qingkong@alibaba-inc.com&gt; * @memberOf fie-fs * @namespace copy-tpl * @exports copy-tpl */ 'use strict'; const fs = require('fs-extra'); const path = require('path'); const _ = require('underscore'); const utils = require('./utils'); const log = require('fie-log')('fie-fs'); _.templateSettings = utils.templateSettings; /** * 复制文件 * 支持 underscore 模板引擎, 标签开始和结束符是: &lt;{% %}&gt; * @param {object} options * @exmaple * options.src 绝对路径 * options.dist 绝对路径 * options.stringReplace 数组 , 将文件里面匹配到的字符串替换掉,如 [ { placeholder: 'PLACEHOLDER', value: 'theReplaceValue' } ] * options.data * */ function copyTpl(options) { options.data = options.data || {}; options.stringReplace = options.stringReplace || []; options.encoding = options.encoding || 'utf-8'; if (!fs.existsSync(options.src)) { log.error(`${options.src} 文件不存在`); return; } if (fs.statSync(options.src).isDirectory()) { fs.mkdirsSync(options.dist); log.success(`${options.dist} 写入成功`); return; } // 数据模板转换 let content = fs.readFileSync(options.src, { encoding: options.encoding }); try { content = _.template(content)(options.data); } catch (err) { log.error(`${options.src} template 失败请检查模板及数据是否正确`); } for (let j = 0; j &lt; options.stringReplace.length; j += 1) { content = content.replace(new RegExp(options.stringReplace[j].placeholder, 'g'), options.stringReplace[j].value); } // 若没有目录文件需要创建,最终创建文件 fs.mkdirsSync(path.dirname(options.dist)); fs.writeFileSync(options.dist, content); log.success(`${options.dist} 写入成功`); } module.exports = copyTpl; × Search results Close "},"fie-fs_lib_rewrite-file.js.html":{"id":"fie-fs_lib_rewrite-file.js.html","title":"Source: fie-fs/lib/rewrite-file.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-fs/lib/rewrite-file.js /** * @desc 重写文件内容, 本文件不提供读写文件能力,使用者自己读写文件(主要考虑一个文件需要多次被重写) * @see http://fie.alibaba.net/doc?package=fie-home * @requires @ali/fie-logger * @author 擎空 &lt;qingkong@alibaba-inc.com&gt; * @memberOf fie-fs * @namespace rewrite-file * @exports rewrite-file */ 'use strict'; const fs = require('fs-extra'); const log = require('fie-log')('fie-fs'); /** * @desc rewriteFile每次调用只能 match 一个hook * @param {object} options * @param {string} options.src 文件路径或内容 * @param {string} options.hook 判断需要插入行的标记 * @param {array} options.insertLines 数组类型, 每一项为新行 * @param {string} options.place before / after(默认) * @param {string} options.noMatchActive top / bottom / null(默认) * @param {number} options.srcMode 0:src是文件路径(默认), 1:src 是文件内容 * @return {string} */ const rewriteFile = (options) =&gt; { let content = ''; options = Object.assign({ src: '', dist: '', hook: '', insertLines: [], place: 'after', noMatchActive: '', srcMode: 0 // 0 src是文件路径, 1 src 是文件内容 }, options); if (options.src === '') { log.error('文件路径不能为空'); return content; } log.debug('关键点debug'); if (options.srcMode === 0) { if (!fs.statSync(options.src).isFile()) { log.error('文件路径指向的不是文件'); return content; } content = fs.readFileSync(options.src).toString(); } else { content = options.src.toString(); } content = hookMatchStr(content, options); if (options.dist) { fs.writeFileSync(options.dist, content); log.success(`${options.dist} 文件写入成功`); } return content; }; /** * @desc Hook a string * @param {string} content string to be hook * @param {object} hookOptions * @param {string} hookOptions.hook 判断需要插入行的标记 * @param {array} hookOptions.insertLines 数组类型, 每一项为新行 * @param {string} hookOptions.place before / after(默认) * @param {string} hookOptions.noMatchActive top / bottom / null(默认) * @return {string} */ const hookMatchStr = (content, hookOptions) =&gt; { if (!content) { throw Error('parama content and options '); } const options = hookOptions || {}; let matchLineIndex = -1; const lines = content.split('\\n'); // 找到 match 的行号 if (options.hook) { for (let i = 0; i &lt; lines.length; i += 1) { if (lines[i].indexOf(options.hook) !== -1) { matchLineIndex = i; break; } } } if (matchLineIndex === -1 &amp;&amp; options.noMatchActive) { // 没有 match 处理 matchLineIndex = options.noMatchActive === 'top' ? 0 : lines.length - 1; } else { // 前后位置处理 options.place === 'after' &amp;&amp; (matchLineIndex += 1); } // 插入内容 if (matchLineIndex !== -1) { lines.splice(matchLineIndex, 0, options.insertLines.join('\\n')); } content = lines.join('\\n'); return content; }; module.exports = rewriteFile; × Search results Close "},"fie-home_lib_index.js.html":{"id":"fie-home_lib_index.js.html","title":"Source: fie-home/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-home/lib/index.js /** * @desc 获取fie及模块的相关路径，不建议插件直接对 fie 家目录里面的内容直接进行操作 * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-home */ 'use strict'; const debug = require('debug')('fie-home'); const path = require('path'); const fs = require('fs-extra'); const mkdirp = require('mkdirp'); const userHome = require('os-homedir')(); const fieHome = process.env.FIE_HOME || userHome; const fiePath = path.resolve(fieHome, '.fie'); const fieModulesPath = path.resolve(fiePath, 'node_modules'); const homePkgPath = path.resolve(fiePath, 'package.json'); const homePkg = { name: 'home', version: '2.0.0' }; /** * @exports fie-home */ module.exports = { /** * 获取FIE的home路径 * @param key {string} 可选参数key * @returns {string} 返回路径字符串 */ getHomePath: () =&gt; fiePath, /** * 获取FIE模块的安装路径 * @returns {string} 返回路径字符串 */ getModulesPath: () =&gt; fieModulesPath, /** * 初始化FIE的home目录 */ initHomeDir: () =&gt; { if (!fs.existsSync(homePkgPath)) { mkdirp(fiePath, '0777'); fs.writeJsonSync(homePkgPath, homePkg); } }, /** * 清理Home目录内容 * 用户手工删除是没影响的，fie 会验证并初始化 */ cleanHomeDir: () =&gt; { if (fs.existsSync(fieModulesPath)) { fs.removeSync(fieModulesPath); } }, /** * 获取FIE的全局配置文件 * @param key {string} 可选参数key * @returns {object} .fie/pageckage.json 的json对象 * @todo how to throw an excetion in fie-package ? */ getGlobalConfig: (key) =&gt; { try { const fieHomePackageJson = JSON.parse(fs.readFileSync(homePkgPath).toString()); return key ? fieHomePackageJson[key] : fieHomePackageJson; } catch (ex) { } } }; × Search results Close "},"fie-log_lib_index.js.html":{"id":"fie-log_lib_index.js.html","title":"Source: fie-log/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-log/lib/index.js /** * @file 获取fie及模块的相关路径，不建议插件直接对 fie 家目录里面的内容直接进行操作 * @see http://fie.alibaba.net/doc?package=fie-home * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-log */ 'use strict'; const chalk = require('chalk'); const debug = require('debug'); /** * @exports fie-log */ module.exports = (moduleName) =&gt; { const message = (content, color) =&gt; { let _content = ''; if (moduleName) { _content += chalk[color](`[${moduleName}] `); } _content += chalk[color](content); console.log(_content); }; return { info(content) { message(content, 'magenta'); }, success(content) { message(content, 'green'); }, warn(content) { message(content, 'yellow'); }, error(content) { message(content, 'red'); }, debug: debug(moduleName) }; }; × Search results Close "},"fie-report_lib_index.js.html":{"id":"fie-report_lib_index.js.html","title":"Source: fie-report/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/index.js /** * @desc 信息上报retcode * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report */ 'use strict'; const execSync = require('child_process').execSync; const path = require('path'); const os = require('os'); const __WPO = require('./retcode/log-node'); const fieHome = require('fie-home'); const fieUser = require('fie-user'); let UserInfo = null; let cacheEnvGetter = {}; /** * 调用时再用git 生成用户信息,尽量减少无用执行 */ function userInfoGetter() { if (!UserInfo) { UserInfo = fieUser.getUser(); } } /** * 获取项目相关环境 */ function getProjectEnv() { const projectData = { cwd: process.cwd(), argv: encodeURIComponent(process.argv.join(' ')) }; try { const pkg = require(path.resolve(projectData.cwd, 'package.json')); projectData.project = pkg.name; projectData.repository = pkg.repository.url; } catch (e) { // no package.json } return projectData; } /** * 获取上报所需的通用参数 * @param force 为 true时, 对 tnpm, node 版本等重新获取,一般在报错的时候才传入 true * @returns {string} */ function getCommonData(force) { const cachedEnv = fieHome.getGlobalConfig('cachedEnv'); const commonDataStr = []; let commonData = {}; // 获取全局环境 if (cachedEnv &amp;&amp; !force) { Object.keys(cacheEnvGetter).forEach((item) =&gt; { commonData[item] = fieHome.getGlobalConfig(item); }); } else { Object.keys(cacheEnvGetter).forEach((item) =&gt; { commonData[item] = cacheEnvGetter[item](); }); } // 获取项目相关环境 commonData = Object.assign({}, commonData, getProjectEnv()); Object.keys(commonData).forEach((key) =&gt; { commonDataStr.push(`${key}=${commonData[key]}`); }); return commonDataStr.join('&amp;'); } cacheEnvGetter = { fieVersion() { return require('../package.json').version; }, name() { userInfoGetter(); return UserInfo.name; }, email() { userInfoGetter(); return UserInfo.email; }, nodeVersion() { return execSync('node -v').toString().replace('\\n', ''); }, npmVersion() { return execSync('npm -v').toString().replace('\\n', ''); }, tnpmVersion() { try { return execSync('tnpm -v').toString().split('\\n')[0].slice(5).replace(/\\([^\\)]+\\)/, ''); } catch (ex) { // 外网无tnpm return 'tnpm not install'; } }, // TODO 控制台上有显示错误 // cnpmVersion() { // try{ // return execSync('cnpm -v').toString().replace('\\n', ''); // } // catch(ex){ // //外网无tnpm // return &quot;cnpm not install&quot; // } // }, system() { return `${os.platform()} ${os.release()}`; } }; /** * @exports fie-report */ module.exports = { /** * 根据核心命令发送日志(spmId: fie-core-command) * @param {string} command 命令串 */ coreCommand(command) { __WPO.setConfig({ spmId: 'fie-core-command' }); const logMsg = `command=${command}&amp;${getCommonData()}`; __WPO.log(logMsg, 1); return { success: true, logMsg }; }, /** * 根据模块名称发送retcode日志(spmId: fie-module-use) * @param {string} command 命令串 */ moduleUsage(name) { __WPO.setConfig({ spmId: 'fie-module-use' }); const logMsg = `moduleName=${name}&amp;${getCommonData()}`; __WPO.log(logMsg, 1); return { success: true, logMsg }; }, /** * 自定义retcode发送日志 (spmId: fie-error) * @param {string} type 错误类型 * @param {object|string} error 信息 */ error(type, err) { if (typeof err === 'object') { err = JSON.stringify(err); } else if (typeof err !== 'string') { err = err.toString(); } __WPO.setConfig({ spmId: 'fie-error' }); const logMsg = `type=${type}&amp;err=${err}&amp;${getCommonData()}`; __WPO.log(logMsg, 1); return { success: true, logMsg }; } }; × Search results Close "},"fie-report_lib_retcode_conf-node.js.html":{"id":"fie-report_lib_retcode_conf-node.js.html","title":"Source: fie-report/lib/retcode/conf-node.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/conf-node.js /** * @desc 配置retcode for node * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports conf-node */ 'use strict'; module.exports = { sendRequest: require('./request-node'), getCookie(wpo) { return wpo.config.cookie; }, getSpmId() { return this.spmId; } }; × Search results Close "},"fie-report_lib_retcode_apis.js.html":{"id":"fie-report_lib_retcode_apis.js.html","title":"Source: fie-report/lib/retcode/apis.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/apis.js /** * @desc 上报日志API * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports apis */ 'use strict'; module.exports = function (wpo, undef) { let startTime, scriptStart; if (wpo.startTime) { startTime = wpo.startTime; } else { try { startTime = window.performance.timing.responseStart; scriptStart = new Date(); } catch (e) { scriptStart = startTime = new Date() - 0; } } const send = function (params, sampling) { sampling = sampling || wpo.config.sample; // // 双十一当天统计数据抽样率降低 // // if ((curDate.getUTCDate() == 10 &amp;&amp; curDate.getUTCMonth() == 10 &amp;&amp; curDate.getUTCHours() &gt;= 16) || // (curDate.getUTCDate() == 11 &amp;&amp; curDate.getUTCMonth() == 10)) { // sampling *= 10; // } if (wpo.sampling(sampling) == (wpo.config.modVal || 1)) { params.sampling = sampling; wpo.send(params); } }; /** * [custom description] * @param {number|string} category [0/'time'，1/'count'] * @param {string} key [自定义值] * @param {object} value [自定义值，如果type为count，自动忽略该值] * @return {void} */ wpo.custom = function (category, key, value) { let customParam = { type: 'custom', usernick: wpo.getNick() }, arr = ['time', 'count']; category = arr[category] || category; if (category == 'time' || category == 'count') { customParam.category = category; } if (customParam.type) { customParam.key = key; customParam.value = category == 'time' ? value : undef; send(customParam); } }; /** * [error description] * @param {string} category [可选参，错误类型，默认为sys] * @param {string} msg [自定义错误信息] * @return {void} */ wpo.error = function (category, msg, file, line) { const errorParam = { type: 'jserror', usernick: encodeURIComponent(wpo.getNick()) }; if (arguments.length == 1) { msg = category; category = undefined; } if (!msg) { return; } errorParam.category = category || 'sys'; errorParam.msg = encodeURIComponent(msg); // // separate msg file name // if (file) { errorParam.file = file; } if (line) { errorParam.line = line; } send(errorParam, 1); }; /** * [performance description] * @param {object} params [性能相关信息] * @return {void} */ wpo.performance = function (params) { const perParam = { type: 'per' }; send(wpo.extend(perParam, params)); }; /** * [retCode description] * @param {string} api [所调用的api] * @param {boolean} issucess [是否成功，不成功会100%发送，成功按照抽样发送] * @param {number|string} delay [调用时间] * @param {string} msg [自定义消息] * @return {void} */ wpo.retCode = function (api, issucess, delay, msg) { const retParam = { type: 'retcode', api: encodeURIComponent(api), issucess, usernick: wpo.getNick(), delay: typeof delay === 'number' ? parseInt(delay, 10) : (new Date() - startTime), msg: encodeURIComponent(msg), sampling: this.config.retCode[api] }; if (typeof retParam.delay !== 'undefined') { send(retParam, issucess ? retParam.sampling : 1); } }; const sendSpeed = function () { let perParam = { type: 'speed' }, val; for (let i = 0, len = wpo.speed.points.length; i &lt; len; i++) { val = wpo.speed.points[i]; if (val) { perParam[`s${i}`] = val; wpo.speed.points[i] = null; } } send(perParam); }; /** * [speed description] * @param {number|string} pos [0/'s0',1/'s1',2/'s2'....10/'s10'] * @param {number|string} delay [耗时，如果没有定义，这按照当前时间减去页面起始时间] * @param {boolean} _immediately [内部使用，是否强制发送，不强制发送会尽量收集3s内的所有点的数据一次性发送] * @return {void} */ wpo.speed = function (pos, delay, _immediately) { let sArr; if (typeof pos === 'string') { pos = parseInt(pos.slice(1), 10); } if (typeof pos === 'number') { sArr = wpo.speed.points || new Array(11); sArr[pos] = typeof delay === 'number' ? delay : new Date() - startTime; if (sArr[pos] &lt; 0) { sArr[pos] = new Date() - scriptStart; } wpo.speed.points = sArr; } clearTimeout(wpo.speed.timer); if (!_immediately) { wpo.speed.timer = setTimeout(sendSpeed, 3000); } else { sendSpeed(); } }; /** * [log 日志统计] * @param {string} msg [发送的内容] * @param {number} sampling [可以自定义发送的抽样] * @return {void} */ wpo.log = function (msg, sampling) { const param = { type: 'log', msg: encodeURIComponent(msg), usernick: encodeURIComponent(wpo.getNick()) }; send(param, sampling); }; }; × Search results Close "},"fie-report_lib_retcode_core.js.html":{"id":"fie-report_lib_retcode_core.js.html","title":"Source: fie-report/lib/retcode/core.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/core.js /** * @desc 上报日志核心方法 * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports core */ 'use strict'; module.exports = function (wpo, root, conf) { let cookies = {}, config = { imgUrl: '//retcode.taobao.com/r.png?', sample: 100, modVal: 1, // startTime: null, // 设置统计起始时间 dynamic: false, // 是否开启动态配置功能 retCode: {} }, uid, guid = 0, timer; const sendRequest = conf.sendRequest; const _send = function () { let params, obj; while (params = core.dequeue()) { obj = core.extend({ uid, spm: config.spmId || core.getSpmId(), times: params.times ? params.times : 1, _t: ~new Date() + (guid++).toString() }, params); if (!obj.spm) { break; } if (wpo.debug &amp;&amp; window.console) { console.log(obj); } sendRequest(config.imgUrl + core.query.stringify(obj)); } timer = null; }; const _wait = function (_clear) { if (_clear &amp;&amp; timer) { clearTimeout(timer); _send(); } if (!timer) { timer = setTimeout(_send, 1000); } }; let core = { ver: '0.1.3', _key: 'wpokey', getCookie(name) { let reg, matches, cookie; if (!cookies[name]) { reg = new RegExp(`${name}=([^;]+)`); // // to make it compatible with nodejs // try { cookie = conf.getCookie(this); } catch (e) { } matches = reg.exec(cookie); if (matches) { cookies[name] = matches[1]; } } return cookies[name]; }, setCookie(key, value, expires, domain, path) { let str = `${key}=${value}`; if (domain) { str += (`; domain=${domain}`); } if (path) { str += (`; path=${path}`); } if (expires) { str += (`; expires=${expires}`); } document.cookie = str; }, extend(target) { const args = Array.prototype.slice.call(arguments, 1); for (let i = 0, len = args.length, arg; i &lt; len; i++) { arg = args[i]; for (const name in arg) { if (arg.hasOwnProperty(name)) { target[name] = arg[name]; } } } return target; }, guid() { return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) =&gt; { let r = Math.random() * 16 | 0, v = c == 'x' ? r : (r &amp; 0x3 | 0x8); return v.toString(16); }); }, send(params) { this.queue(params); // sendRequest(config.imgUrl + core.query.stringify(obj)); }, query: { stringify(params) { const arr = []; for (const name in params) { if (params.hasOwnProperty(name) &amp;&amp; params[name] !== undefined) { arr.push(`${name}=${params[name]}`); } } return arr.join('&amp;'); }, parse(str) { let pairs = str.split('&amp;'), obj = {}, pair; for (let i = 0, len = pairs.length; i &lt; len; i++) { pair = pairs[i].split('='); obj[pair[0]] = pair[1]; } return obj; } }, getSpmId() { if (config.spmId) { return config.spmId; } else if (typeof conf.getSpmId === 'function') { return conf.getSpmId.call(this); } return 0; }, on(el, type, func, isRemoving) { if (el.addEventListener) { el.addEventListener(type, isRemoving ? () =&gt; { el.removeEventListener(type, func, false); func(); } : func, false); } else if (el.attachEvent) { el.attachEvent(`on${type}`, function () { if (isRemoving) { el.detachEvent(`on${type}`, arguments.callee); } func(); }); } }, getNick() { let result; try { return TB.Global.util.getNick(); } catch (e) { result = this.getCookie('_nk_') || this.getCookie('_w_tb_nick') || this.getCookie('lgc'); return decodeURIComponent(result); } }, setConfig(conf) { return core.extend(config, conf); }, dynamicConfig(obj) { const config = this.stringifyData(obj); try { localStorage.setItem(this._key, config); } catch (e) { this.setCookie(this._key, config, new Date(obj.expTime)); } this.setConfig({ sample: parseInt(obj.sample, 10) }); this.ready(); }, parseData(str) { let pairs = str.split('&amp;'), pair, obj = {}; for (let i = 0, len = pairs.length; i &lt; len; i++) { pair = pairs[i].split('='); obj[pair[0]] = pair[1]; } return obj; }, stringifyData(obj) { const params = []; for (const name in obj) { if (obj.hasOwnProperty(name)) { params.push(`${name}=${obj[name]}`); } } if (params.length) { return params.join('&amp;'); } return ''; }, ready(_immediately) { this._ready = true; this._immediately = _immediately; _wait(); }, queue(obj) { let queue = this.requestQueue, compare; if (obj.type === 'jserror') { if (queue.length) { compare = queue[queue.length - 1]; if (obj.msg === compare.msg) { compare.times++; return; } } if (!obj.times) { obj.times = 1; } } queue.push(obj); if (this._ready) { // // for nodejs // if (this._immediately) { _send(); } else { _wait(); } } }, dequeue() { return this.requestQueue.shift(); }, clear() { _wait(true); }, // // dynamically updates itself without queue // requestQueue: wpo.requestQueue || [] }; // core.getSpmId = conf.getSpmId.bind(core); uid = core.guid(); wpo.uid = uid; core.config = core.setConfig(wpo.config); core.extend(wpo, core); root.__WPO = wpo; return wpo; }; × Search results Close "},"fie-report_lib_retcode_request-node.js.html":{"id":"fie-report_lib_retcode_request-node.js.html","title":"Source: fie-report/lib/retcode/request-node.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/request-node.js /** * @desc http(s) 请求 * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports conf-node */ 'use strict'; const http = require('https'); /** * @desc 发送http请求方法 * @param {string} url * @returns {void} */ let httpRequest = function (url) { if (url.indexOf('https:') != 0 &amp;&amp; url.indexOf('//') == 0) { url = `https:${url}`; } const sendRequest = http.request(url, (res) =&gt; { //发送即可暂时考虑不需做处理 }); //加异常捕获避免影响业务 sendRequest.on('error', (err) =&gt; { //暂时考虑不需做处理 }); sendRequest.end(); }; module.exports = httpRequest; × Search results Close "},"fie-report_lib_retcode_sampling.js.html":{"id":"fie-report_lib_retcode_sampling.js.html","title":"Source: fie-report/lib/retcode/sampling.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/sampling.js /** * @desc 抽样算法 * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports sampling */ 'use strict'; /** * @desc 随机抽样算法 * @param {Object} 对象 * @returns {Object} 对象原型附上sampling 方法 */ let sampling = function (wpo) { const map = {}; wpo.sampling = function (mod) { if (mod == 1) { // 100% return 1; } else if (typeof map[mod] === 'number') { //直接返回缓存的计算结果 return map[mod]; } // 抽样算法改为Math.random map[mod] = Math.floor(Math.random() * mod); return map[mod]; }; }; module.exports = sampling; /* 以下是原算法- * 修改抽样算法，以前以uid作为抽样的key，在大于100抽样率下会呈现正态分布 * 改用random可以规避这个问题 (function (n) { var guid = function () { return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) { var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r&amp;0x3|0x8); return v.toString(16); }); }; var parseGuid = function (uid) { var num = 0; for (var i = 0, len = uid.length; i &lt; len; i++) { num += uid.charCodeAt(i); } return num; }; var arr = []; for (var i = 0, n = n || 1000000; i++ &lt; n;) { // arr.push(parseGuid(guid()) % 100); arr.push(Math.floor(Math.random() * 100)); } var map = {}; arr.forEach(function (num) { if (!map[num]) { map[num] = 0; } map[num]++; }); console.log(map); })(); */ × Search results Close "},"fie-report_lib_retcode_log-node.js.html":{"id":"fie-report_lib_retcode_log-node.js.html","title":"Source: fie-report/lib/retcode/log-node.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-report/lib/retcode/log-node.js /** * @desc 上报日志入口(this.__WPO) * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-report * @memberOf fie-report * @exports log-node */ 'use strict'; require('./core')(this.__WPO || {}, this, require('./conf-node')); require('./sampling')(this.__WPO || {}); require('./apis')(this.__WPO || {}); this.__WPO.ready(true); module.exports = this.__WPO; × Search results Close "},"fie-user_lib_index.js.html":{"id":"fie-user_lib_index.js.html","title":"Source: fie-user/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-user/lib/index.js /** * @desc 根据用户当前 git 信息去获取用户相关信息 * @see http://fie.alibaba.net/doc?package=fie-user * @author 六韬 &lt;yubhbh@gmail.com&gt; * @namespace fie-user */ 'use strict'; const log = require('fie-log')('fie-user'); const spawn = require('cross-spawn'); /** * @exports fie-user */ module.exports = { /** * 获取用户信息 * @returns {Object} userInfo 返回用户信息 * @returns {string} userInfo.name 用户名 * @returns {string} userInfo.email 用户Email */ getUser() { const userInfo = { name: '', email: '' }; const reg = /user\\.name=([^\\n]+)\\nuser\\.email=([^\\n]+)/; try { const results = spawn.sync('git', ['config', '--list']); if (results.stdout) { const match = results.stdout.toString().match(reg); if (match &amp;&amp; match.length &gt; 1) { userInfo.name = match[1]; userInfo.email = match[2]; } else { let msg = 'git config --list 没有git 信息,请检查git是否正确配置了用户名和email'; log.debug(msg); } } else { const msg = '没有安装git'; log.debug(msg); } } catch (ex) { log.debug(&quot;fie-user&quot;,ex); throw ex; } return userInfo; } }; × Search results Close "},"fie-core_commands_ii.js.html":{"id":"fie-core_commands_ii.js.html","title":"Source: fie-core/commands/ii.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/ii.js /** */ const fieNpm = require('fie-npm'); const argv = require('yargs').argv; module.exports = function* () { const modules = argv._.slice(1); delete argv._; delete argv.$0; if (modules.length) { yield fieNpm.install(modules, argv); } else { yield fieNpm.installDependencies(argv); } }; × Search results Close "},"fie-core_commands_version.js.html":{"id":"fie-core_commands_version.js.html","title":"Source: fie-core/commands/version.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/version.js /** * @author 擎空 &lt;zernmal@foxmail.com&gt; */ const fiePkg = require('../package.json'); const log = require('fie-log')('fie-core'); module.exports = function* () { log.info(`current version is v${fiePkg.version}`); }; × Search results Close "},"fie-core_commands_list.js.html":{"id":"fie-core_commands_list.js.html","title":"Source: fie-core/commands/list.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/list.js /** * 列出所有的fie套件,插件 * @author 擎空 &lt;zernmal@foxmail.com&gt; */ 'use strict'; const fieModule = require('fie-module'); const chalk = require('chalk'); /** * 设置字符串边距 * @param str * @param width * @returns {string} */ function getPadding(str, width) { const spaceLen = (typeof width === 'undefined' ? 30 : width) - str.length; let padding = ''; padding += ' '; for (let i = 2; i &lt; spaceLen; i++) { padding += '-'; } padding += ' '; return padding; } function printListByType(type, modules) { let tmpString; modules.filter(item =&gt; !!item.name.match(`fie-${type}`)) .forEach((item) =&gt; { const padding = getPadding(item.name, 35); tmpString = [ ' ', chalk.green(item.name), chalk.gray(padding), item.description ? item.description : '暂无描述' ].join(''); console.log(tmpString); }); } /** * 显示套件列表 * @param cliArgs * @param options * @param options.callback */ module.exports = function* (cliArgs, options) { const type = cliArgs.pop(); const fixType = type === 'plugin' || type === 'toolkit' ? type : null; const textMap = { plugin: '插件', toolkit: '套件', all: '套件/插件' }; const text = textMap[fixType || 'all']; const star = fixType ? '**' : ''; const param = { fixType }; options = options || {}; const local = yield fieModule.localList(param); const online = yield fieModule.onlineList(param); const newList = []; // merge list const onlineKeys = online.map((item) =&gt; { newList.push(item); return item.name; }); local.forEach((item) =&gt; { if (onlineKeys.indexOf(item.name) === -1) { newList.push(item); } }); console.log(chalk.italic.magenta(`\\r\\n${star}************** fie ${text}列表 ******************${star}\\r\\n`)); if (!type) { console.log(chalk.magenta('- 套件列表 \\r\\n')); printListByType('toolkit', newList, options); console.log(chalk.magenta('\\r\\n- 插件列表 \\r\\n')); printListByType('plugin', newList, options); } else { printListByType(type, newList, options); } console.log(chalk.italic.magenta('\\r\\n***************************************************\\r\\n')); }; × Search results Close "},"fie-module_lib_local-list.js.html":{"id":"fie-module_lib_local-list.js.html","title":"Source: fie-module/lib/local-list.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-module/lib/local-list.js 'use strict'; /** * Created by hugo on 16/11/20. */ const globby = require('globby'); const log = require('fie-log')('fie-module'); const env = require('fie-env'); const home = require('fie-home'); const utils = require('./utils'); const path = require('path'); const fs = require('fs-extra'); const isIntranet = env.isIntranet(); const fieModulesPath = home.getModulesPath(); function localList(options) { options = options || {}; const moduleCwd = isIntranet ? path.resolve(fieModulesPath, '@ali') : fieModulesPath; let modules = globby.sync([ 'fie-plugin-*', 'fie-plugin-*', 'fie-toolkit-*', 'fie-plugin-*', '!.*', '!*.*' ], { cwd: moduleCwd }); modules = modules.map((item) =&gt; { const modPkg = fs.readJsonSync(path.resolve(moduleCwd, item, 'package.json')); return { name: modPkg.name, description: modPkg.description }; }); modules = options.type ? utils.moduleFilter(modules, options.type) : modules; log.debug('所有本地模块: %o', modules); return modules; } module.exports = localList; × Search results Close "},"fie-task_lib_run-function.js.html":{"id":"fie-task_lib_run-function.js.html","title":"Source: fie-task/lib/run-function.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-task/lib/run-function.js 'use strict'; /** * 判断当前对象是否为 generator 对象 * @param obj * @returns {boolean} */ function isGenerator(obj) { return typeof obj.next === 'function' &amp;&amp; typeof obj.throw === 'function'; } /** * 判断当前对象是否为 generator 函数 * @param obj * @returns {boolean} */ function isGeneratorFunction(obj) { const constructor = obj.constructor; if (!constructor) return false; if (constructor.name === 'GeneratorFunction' || constructor.displayName === 'GeneratorFunction') return true; return isGenerator(constructor.prototype); } /** * 执行某个函数 * 如果是 generator 类型,则使用 yield执行, 并在其后执行 next(0\\) * 否则普通调用, 并传入 next 函数 * @param options.method {function} 函数体 * @param options.args {array} 参数 * @param options.next {function} 下一步执行方法 * @return {mix} 函数体内的返回值 */ function* runFunction(options) { const noop = () =&gt; {}; const method = options.method; const args = options.args || []; const next = options.next || noop; if (isGeneratorFunction(method) || isGenerator(method)) { const res = yield method.apply(null, args); next(); return res; } else { const res = method.apply(null, args.concat(next)); // return 为 promise 对象的情况 if (res &amp;&amp; typeof res.then === 'function') { const res2 = yield res; next(); return res2; } return res; } } module.exports = runFunction; × Search results Close "},"fie-core_commands_init.js.html":{"id":"fie-core_commands_init.js.html","title":"Source: fie-core/commands/init.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/init.js /** * 套件 generate 初始化模板操作 */ 'use strict'; const fieModule = require('fie-module'); const cwd = process.cwd(); const chalk = require('chalk'); const inquirer = require('inquirer'); const fs = require('fs-extra'); const log = require('fie-log')('fie-core'); const task = require('fie-task'); const api = require('../lib/api'); const path = require('path'); function* runInit(name) { const moduleInfo = yield fieModule.get(name); yield task.runFunction({ method: moduleInfo.mod.init, args: [api.getApi(name), {}] }); } function* getName() { const choices = []; const onlineList = yield fieModule.onlineList({ type: 'toolkit' }); const localList = fieModule.localList({ type: 'toolkit' }); const onlineMap = {}; const addChoice = (item) =&gt; { const n = item.name.replace('@ali/', '').replace('fie-toolkit-', ''); choices.push({ name: n + chalk.gray(` - ${item.description}`), value: n }); }; console.log(localList, onlineList); onlineList.forEach((item) =&gt; { addChoice(item); onlineMap[item.name] = true; }); localList.forEach((item) =&gt; { if (!onlineMap[item.name]) { addChoice(item); } }); const answers = yield inquirer.prompt([{ type: 'list', name: 'name', message: '请选择一个适合您项目的套件进行初始化:', choices }]); return answers.name; } module.exports = function* (args) { let name = args.pop(); if (!name) { // 未传入套件名,提示并列出可用套件名 name = yield getName(); } name = fieModule.toolkitFullName(name); // 先判断fie.config.js 是否存在 // 存在的话,提示已初始化过了 // 不存在的话再判断文件夹是否为空 // 不为空的话则提示覆盖 if (fs.existsSync(path.join(cwd, 'fie.config.js'))) { log.warn('该项目已初始化过,无需再次进行init'); log.warn('若想重新初始化,请删除项目中的 fie.config.js 文件'); return; } // 排除那些以点开头的文件 const files = fs.readdirSync(cwd).filter(file =&gt; file.indexOf('.') !== 0); if (files.length &gt; 0) { log.warn('当前目录下已存在文件,继续执行初始化会覆盖已存在的同名文件'); const questions = [{ type: 'input', name: 'check', message: '确认需要继续执行初始化,请输入(y)' }]; const answers = yield inquirer.prompt(questions); if (answers.check === 'y' || answers.check === 'Y') { yield runInit(name); } } else { yield runInit(name); } }; × Search results Close "},"fie-module_lib_local-exist.js.html":{"id":"fie-module_lib_local-exist.js.html","title":"Source: fie-module/lib/local-exist.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-module/lib/local-exist.js 'use strict'; const utils = require('./utils'); const fs = require('fs-extra'); const path = require('path'); const home = require('fie-home'); /** * 模块是否存在 */ function localExist(name) { name = utils.fullName(name); const modulePath = path.resolve(home.getModulesPath(), name); const pkgPath = path.resolve(modulePath, 'package.json'); return fs.existsSync(pkgPath); } module.exports = localExist; × Search results Close "},"fie-error_lib_handle-enoent.js.html":{"id":"fie-error_lib_handle-enoent.js.html","title":"Source: fie-error/lib/handle-enoent.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/handle-enoent.js 'use strict'; /** * Created by hugo on 16/11/16. */ const log = require('fie-log')('fie-error'); const utils = require('./utils'); const fieEnv = require('fie-env'); const _ = require('lodash'); // 处理 module.exports = function (e) { if (e.code !== 'ENOENT') { return false; } const match = e.message.match(/spawn(.*)ENOENT/); if (match &amp;&amp; match[0]) { const module = match[1].trim(); const isIntranet = fieEnv.isIntranet(); const installer = isIntranet ? 'tnpm' : 'npm'; log.error(`运行插件或套件时出现了错误, 未找到 ${module} 命令,请看下是否有安装!`); // 本地模块 if (module.indexOf('node_modules') !== -1) { const cmdArr = module.split('/'); const startIdx = _.indexOf(cmdArr, 'node_modules'); let runModule; // 直接运行命令 if (module.indexOf('node_modules/.bin/') !== -1) { runModule = cmdArr[cmdArr.length - 1]; } else if (module.indexOf('node_modules/@ali') !== -1 &amp;&amp; cmdArr.length &gt;= 2) { // 本地文件直接运行 runModule = `${cmdArr[startIdx + 1]}/${cmdArr[startIdx + 2]}`; } else { runModule = cmdArr[startIdx + 1]; } log.error(`修复建议: 在控制台执行 ${installer} install ${runModule} 试试!`); } else { log.error(`修复建议: 在控制台执行 ${installer} install -g ${module} 试试!`); } return true; } }; × Search results Close "},"fie-error_lib_handle-module-not-found.js.html":{"id":"fie-error_lib_handle-module-not-found.js.html","title":"Source: fie-error/lib/handle-module-not-found.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/handle-module-not-found.js 'use strict'; /** * Created by hugo on 16/11/16. */ const log = require('fie-log')('fie-error'); const utils = require('./utils'); const fieHome = require('fie-home'); const fieNpm = require('fie-npm'); // 处理 module.exports = function* (e) { if (e.code !== 'MODULE_NOT_FOUND') { return false; } const match = e.message.match(/'(.*)'/); const cwd = process.cwd(); // 排除 相对路径 ../ &amp; ./ 的情况( . 开头) if (match &amp;&amp; match[0] &amp;&amp; match[0].indexOf('.') !== 1) { const module = utils.pureModuleName(match[1]); log.error(`运行插件或套件时出现了错误, 未找到 ${module} 模块! FIE正在尝试自动修复...`); let moduleCwd = fieHome.getHomePath(); // 判断一下如果是项目文件中抛出的报错,则需要安装在项目文件夹中 if (e.stack &amp;&amp; e.stack.toString().indexOf(cwd) !== -1) { moduleCwd = cwd; // 这种情况下极有可能是本地的相关依赖没有安装,先全部执行一次安装 yield fieNpm.installDependencies(); log.success('成功安装当前项目中的依赖,请重新运行命令!'); } try { // 安装所需的依赖 yield fieNpm.install(module, { cwd: moduleCwd }); log.success(`已将 ${module} 模块安装至 ${moduleCwd} ,自动修复成功,请重新运行命令!`); } catch (e) { log.error('sorry 自动修复失败, 请手动修复'); } } else if (match &amp;&amp; match.length === 2) { log.error(`运行时出现了错误, 未找到 ${match[1]} 文件,请确认 ${match[1]} 是否存在!`); if (e.stack) { log.error('详细错误堆栈信息如下:'); console.log(e.stack); } return true; } }; × Search results Close "},"fie-config_lib_ast-analyze.js.html":{"id":"fie-config_lib_ast-analyze.js.html","title":"Source: fie-config/lib/ast-analyze.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-config/lib/ast-analyze.js 'use strict'; const esprima = require('esprima'); const esquery = require('esquery'); const escodegen = require('escodegen'); const toSource = require('tosource'); /** * 分析一下fie.config.js,搜索key值,写入value,最终合并后输出源码 * @param code fie.config.js文件源码 * @param key 需要插入或者修改的 key * @param value key对应的值 * @returns {*} */ module.exports = function (code, key, value) { let ast; // 支持 tasks.start 这种写法 const keyArr = key.split('.'); const keySelect = keyArr.map(item =&gt; `ObjectExpression &gt; [key.name=&quot;${item}&quot;]`); if (typeof value !== 'string') { value = toSource(value); } ast = esprima.parse(code, { range: true, tokens: true, comment: true }); ast = escodegen.attachComments(ast, ast.comments, ast.tokens); // 将需要插入的value进行ast转换 const valueAST = esprima.parse(`var temp = ${value}`, { attachComment: true }); // 提取value的ast对象 const keyMatches = esquery(valueAST, 'Program &gt; VariableDeclaration &gt; VariableDeclarator'); const pushAST = keyMatches[0].init; // 查找fie.config中是否存在这个key const matches = esquery(ast, keySelect.join('&gt;')); // fie 最外层的对象 const topMatches = esquery(ast, 'Program &gt; ExpressionStatement &gt; AssignmentExpression &gt; ObjectExpression'); // 如果已经存在key的话,则替换值 if (matches.length &amp;&amp; matches[0].value) { matches[0].value = pushAST; } else if (keyArr.length === 1) { // 不存在key的情况 且是非数组的情况 topMatches[0].properties.push({ type: 'Property', key: { type: 'Identifier', name: key }, value: pushAST }); } else { // 不存在key的情况 const objMatches = esquery(topMatches[0], `ObjectExpression &gt; [key.name=&quot;${keyArr[0]}&quot;]`); // TODO 暂只处理 xxx.yyy 这种情况,若需要多级插入,比较麻烦,等有空了且存在这样的需求再考虑. // 存在xxx 不存在yyy if (objMatches.length) { objMatches[0].value.properties.push({ type: 'Property', key: { type: 'Identifier', name: keyArr[1] }, value: pushAST }); } else { // 不存在xxx 且不存在 yyy topMatches[0].properties.push({ type: 'Property', key: { type: 'Identifier', name: keyArr[0] }, value: { type: 'ObjectExpression', properties: [{ type: 'Property', key: { type: 'Identifier', name: keyArr[1] }, value: pushAST }] } }); } } // 最后返回源码 return escodegen.generate(ast, { comment: true }); }; × Search results Close "},"fie-core_commands_switch.js.html":{"id":"fie-core_commands_switch.js.html","title":"Source: fie-core/commands/switch.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/switch.js 'use strict'; const inquirer = require('inquirer'); const fieEnv = require('fie-env'); const chalk = require('chalk'); const log = require('fie-log')('fie-core'); /** * 初始化环境 */ module.exports = function* () { const divider = '- '; const answers = yield inquirer.prompt([{ type: 'list', name: 'name', message: '请选择FIE的开发环境:', choices: [{ name: `阿里内网环境 ${divider}${chalk.gray('阿里员工/可使用VPN登录阿里内网的用户')}`, value: 'intranet', short: '阿里内网环境' }, { name: `外网环境 ${divider}${chalk.gray('ISV/无法访问阿里内网的用户')}`, value: 'extranet', short: '外网环境' }] }]); // 设置env环境 fieEnv.setEnv(answers.name); log.success('成功初始化FIE的开发环境!'); }; × Search results Close "},"fie-core_commands_all.js.html":{"id":"fie-core_commands_all.js.html","title":"Source: fie-core/commands/all.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/all.js /** * * 所有的套件/插件都走这个命令 */ 'use strict'; const co = require('co'); const log = require('fie-log')('fie-core'); const fieTask = require('fie-task'); const fieConfig = require('fie-config'); const fieModule = require('fie-module'); const report = require('fie-report'); const fieError = require('fie-error'); const api = require('../lib/api'); const argv = require('yargs').argv; let fieObject; /** * 运行插件命令 * @param name * @param cliArgs * @param next */ function* runPlugin(name, cliArgs) { name = fieModule.pluginFullName(name); fieObject = api.getApi(name); // 执行插件的方法 let exist = fieModule.localExist(name); log.debug(`${name} 插件本地是否存在: ${exist}`); if (!exist) { exist = yield fieModule.onlineExist(name); log.debug(`${name} 线上是否存在: ${exist}`); } if (exist) { const plugin = yield fieModule.get(name); log.debug(' 插件信息 %o', plugin); yield fieTask.runFunction({ method: plugin.mod, args: [fieObject, { clientArgs: cliArgs }] }); } else { log.error(`${name} 插件不存在`); } } /** * 执行命令, 调用优先级是 core &gt; task &gt; toolkit &gt; plugin * @param command * @param cliArgs * @returns {*} */ module.exports = function* (command, cliArgs) { const tasks = fieConfig.get('tasks') || {}; const hasBeforeTask = fieTask.has(tasks[command], 'before'); const hasAfterTask = fieTask.has(tasks[command], 'after'); log.debug(' tasks = %o , command = %s', tasks, command); log.debug(`before task ${hasBeforeTask}`); // ------------- 执行前置任务 --------------- if (hasBeforeTask) { yield fieTask.run({ tasks: tasks[command], args: [api.getApi(), { clientArgs: argv }], when: 'before', command }); } // -------------- 执行套件任务 --------------- const toolkitName = fieConfig.exist() ? (fieConfig.get('toolkit') || fieConfig.get('toolkitName')) : ''; const toolkitExist = toolkitName ? (fieModule.localExist(toolkitName) || fieModule.onlineExist(toolkitName)) : false; const toolkit = toolkitExist ? yield fieModule.get(toolkitName) : null; // 如果判断到有套件且有对应命令的方法,那么直接执行并返回, 否则向下执行插件逻辑 if (toolkit &amp;&amp; toolkit.mod &amp;&amp; toolkit.mod[command]) { log.debug(`找到套件 ${toolkitName} 对应的 ${command} 方法`); fieObject = api.getApi(fieModule.toolkitFullName(toolkitName)); if (command === 'add') { cliArgs.type = cliArgs.length &gt; 0 ? cliArgs[0] : ''; cliArgs.name = cliArgs.length &gt; 1 ? cliArgs[1] : ''; } yield fieTask.runFunction({ method: toolkit.mod[command], args: [fieObject, { clientArgs: cliArgs }], next() { // -------------- 执行后置任务 --------------- // next 是异步的方法, run 是 generator方法,所以需要用 co 包一层 hasAfterTask &amp;&amp; co(function* () { yield fieTask.run({ tasks: tasks[command], args: [fieObject, cliArgs], when: 'after', command }); }).catch(err =&gt; fieError.handle(err)); } }); return; } else if (hasAfterTask) { log.debug('未找到对应的套件及方法'); // 只有后置命令, 却没有套件模块的给个提示 log.error(`未找到 ${command} 对应的套件命令,后置任务无法执行`); return; } // -------------- 执行插件任务 --------------- // 在已经执行了任务流的情况下,直接不执行插件逻辑 if (!hasBeforeTask &amp;&amp; !hasAfterTask) { log.debug('尝试执行插件方法'); yield runPlugin(command, cliArgs); } }; × Search results Close "},"fie-core_lib_init-env.js.html":{"id":"fie-core_lib_init-env.js.html","title":"Source: fie-core/lib/init-env.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/lib/init-env.js 'use strict'; const inquirer = require('inquirer'); const fieEnv = require('fie-env'); const chalk = require('chalk'); const log = require('fie-log')('fie-core'); /** * 初始化环境 */ module.exports = function* () { const hasInitEnv = fieEnv.hasConfigFile(); // 已经初始化过了,则退出 if (hasInitEnv) return null; log.warn('检测到您尚未初始化FIE的开发环境!'); yield require('../commands/switch')(); log.success('也可以使用 $ fie switch 命令进行FIE开发环境的切换!'); process.exit(10); }; × Search results Close "},"fie-npm_lib_index.js.html":{"id":"fie-npm_lib_index.js.html","title":"Source: fie-npm/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-npm/lib/index.js 'use strict'; const debug = require('debug')('fie-npm'); const spawn = require('cross-spawn'); const _ = require('lodash'); const path = require('path'); const dargs = require('dargs'); const request = require('co-request'); const fieEnv = require('fie-env'); const isIntranet = fieEnv.isIntranet(); const registry = isIntranet ? 'http://registry.npm.alibaba-inc.com/' : 'http://registry.npm.taobao.org/'; function* runInstall(installer, paths, options) { debug('installer = %s', installer); // npm默认值 const option = _.defaults(options || {}, { registry, china: true, stdio: 'inherit', cwd: process.cwd() }); // 将pkg进行扁平化 paths = Array.isArray(paths) ? paths : paths &amp;&amp; paths.split(' ') || []; // TODO 确认一下是不是这样用法 const args = paths.concat(dargs(option, { aliases: { S: '-save', D: '-save-dev', O: '-save-optional', E: '-save-exact' } })); debug('args = %o', args); debug('options = %o', option); return yield new Promise((resolve, reject) =&gt; { spawn(installer, args, option) .on('error', (e) =&gt; { reject(e); }) .on('exit', (err) =&gt; { if (err) { reject(Error(`install ${paths} error`)); } else { resolve(); } }); }); } module.exports = { /** * 安装npm 包 * @param pkg * @param options */ * install(pkg, options) { const installer = path.resolve(__dirname, '../node_modules/.bin/npminstall'); yield runInstall(installer, pkg, options); }, /** * 移除npm包 */ * unInstall(pkg, options) { const installer = path.resolve(__dirname, '../node_modules/.bin/npmuninstall'); yield runInstall(installer, pkg, options); }, /** * 安装package.json 中的依赖 */ * installDependencies(options) { const installer = path.resolve(__dirname, '../node_modules/.bin/npminstall'); yield runInstall(installer, null, options); }, /** * 获取最新的包信息 */ * latest(name, options) { options = Object.assign({}, { registry }, options); let body = null; try { const res = yield request(`${options.registry}${encodeURIComponent(name)}/latest`); body = JSON.parse(res.body); if (body.error) { body = null; } } catch (e) { // 返回数据出错 body = null; } return body; }, /** * 是否存在模块 * @param name */ * has(name, options) { options = Object.assign({}, { registry }, options); const res = yield request({ url: `${options.registry}${encodeURIComponent(name)}/latest`, method: 'HEAD' }); return /4\\d\\d/.test(res.statusCode) === false; } }; × Search results Close "},"fie-error_lib_utils.js.html":{"id":"fie-error_lib_utils.js.html","title":"Source: fie-error/lib/utils.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-error/lib/utils.js /** * Created by hugo on 16/11/18. */ 'use strict'; const log = require('fie-log')('fie-error'); const report = require('fie-report'); const handleList = []; module.exports = { /** * 处理模块名,返回正确的名称 * abc/abc.js * @ali/abc/a.js * @ali/abc * abc */ pureModuleName(moduleName) { const modules = moduleName.split('/'); let module = moduleName; // @ali/xxx,@alife/xxx的情况 if (modules.length &gt; 1) { if (modules[0].indexOf('@ali') !== -1) { module = `${modules[0]}/${modules[1]}`; } else { module = modules[0]; } } return module; }, register(handle) { if (typeof handle === 'function') { handleList.push(handle); } }, getHandleList() { return handleList; } }; × Search results Close "},"fie-core_commands_uninstall.js.html":{"id":"fie-core_commands_uninstall.js.html","title":"Source: fie-core/commands/uninstall.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/uninstall.js /** * @author 擎空 &lt;zernmal@foxmail.com&gt; */ 'use strict'; const fieModule = require('fie-module'); const log = require('fie-log')('fie-core'); module.exports = function* (cliArgs) { const options = { name: cliArgs.pop() }; if (options.name) { options.name = options.name.replace('@ali/', ''); options.name = (options.name.indexOf('fie-') === -1) ? `fie-${options.name}` : options.name; yield fieModule.unInstall(options.name); log.success(`卸载 ${options.name} 成功`); } else { log.error('请输入需要卸载的fie模块名'); } }; × Search results Close "},"fie-utils_lib_index.js.html":{"id":"fie-utils_lib_index.js.html","title":"Source: fie-utils/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-utils/lib/index.js 'use strict'; // const debug = require('debug')('fie-utils'); /** * @exports fie-utils */ module.exports = { }; × Search results Close "},"fie-task_lib_run.js.html":{"id":"fie-task_lib_run.js.html","title":"Source: fie-task/lib/run.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-task/lib/run.js 'use strict'; const log = require('fie-log')('fie-task'); const runFunction = require('./run-function'); const spawn = require('cross-spawn'); const co = require('co'); const utils = require('./utils'); const COMMAND_PARAM_HOOK = '$$'; /** * 运行单个任务 * @param task * @param args * @param hookParam * @return {boolean} 是否继续往下执行, 为 false 的话,不继续执行,后面进程直接退出 */ function* oneTask(task, args, hookParam) { // 设置环境变量 const env = task.env || {}; const oldEnv = {}; Object.keys(env).forEach(item =&gt; { oldEnv.item = process.env[item]; process.env[item] = env[item]; }); const resetEnv = () =&gt; { Object.keys(oldEnv).forEach(item =&gt; { process.env[item] = oldEnv[item]; }); }; // task是一个function时,执行function if (task.func) { const res = yield runFunction({ method: task.func, args }); resetEnv(); return res; } else if (task.command) { return yield new Promise((resolve, reject) =&gt; { const command = task.command.replace(COMMAND_PARAM_HOOK, hookParam).split(' '); const child = spawn(command.splice(0, 1).pop(), command, { cwd: process.cwd(), env: process.env, stdio: 'inherit' }); // 任务流执行失败 child.on('error', (err) =&gt; { resetEnv(); reject(err); }); child.on('close', (status) =&gt; { // 插件自己要退出,则不抛出异常 // TODO 找潕量的插件验证一下, 还要考虑 eslint 等情况 if (status === 10) { resetEnv(); resolve(false); } else if (status !== 0) { const message = `${task.command} 命令执行行失败`; log.error(message); resetEnv(); // 这里抛出的错误和全局扑获的错误重复了,先不执行reject吧 // 看图:http://img3.tbcdn.cn/5476e8b07b923/TB1rrl.OpXXXXb4XFXXXXXXXXXX // reject(new Error(message)); } else { resetEnv(); resolve(true); } }); }); } resetEnv(); return true; } function getHookParam(command) { let match = false; const param = []; process.argv.forEach((item) =&gt; { if (item === command) { match = true; } else if (match) { param.push(item); } }); return param.join(' '); } /** * 运行任务 * @param options */ function* run(options) { // 筛选出对应的任务 const noop = () =&gt; { }; const tasks = options.tasks || []; // 任务流 const when = options.when || 'before'; // 前置任务还是后置,默认是前置任务 const args = options.args || []; // 任务流传进来的参数 const next = options.next || noop; // 进入下一个task const command = options.command || ''; // 运行的命令 const newTasks = utils.classify(tasks)[when]; const hookParam = getHookParam(command); log.info(`正在执行行${command}${(when === 'after' ? '后置' : '前置')}任务`); for (let i = 0; i &lt; newTasks.length; i += 1) { if (newTasks[i].async) { // 异步执行 co(function* () { yield oneTask(newTasks[i], args, hookParam); }); } else { const result = yield oneTask(newTasks[i], args, hookParam); if (result === false) { // 用户强制要求退出,则正常退出一下 process.exit(0); } } } log.success(`${command}${(when === 'after' ? '后置' : '前置')}任务执行成功`); next(); } module.exports = run; × Search results Close "},"fie-module_lib_online-exist.js.html":{"id":"fie-module_lib_online-exist.js.html","title":"Source: fie-module/lib/online-exist.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-module/lib/online-exist.js /** * Created by hugo on 16/11/20. */ 'use strict'; const npm = require('fie-npm'); const utils = require('./utils'); /** * 模块是否存在 */ function* onlineExist(name) { name = utils.fullName(name); return yield npm.has(name); } module.exports = onlineExist; × Search results Close "},"fie-module_lib_online-list.js.html":{"id":"fie-module_lib_online-list.js.html","title":"Source: fie-module/lib/online-list.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-module/lib/online-list.js 'use strict'; const log = require('fie-log')('fie-module'); const env = require('fie-env'); const home = require('fie-home'); const cache = require('fie-cache'); const utils = require('./utils'); const request = require('co-request'); const isIntranet = env.isIntranet(); const searchApi = (key) =&gt; { const end = `browse/keyword/${encodeURIComponent(key)}?type=json&amp;__t=${Date.now()}`; return isIntranet ? `http://web.npm.alibaba-inc.com/${end}` : `https://npm.taobao.org/${end}`; }; /** * 获取列表, 缓存机制 * @returns {*|Request|Array} */ function* onlineList(options) { options = Object.assign({}, { cache: true }, options); log.debug('get online list from cache %o', cache.get(utils.ONLINE_MODULE_CACHE_KEY)); const start = Date.now(); let moduleList = options.cache &amp;&amp; cache.get(utils.ONLINE_MODULE_CACHE_KEY) || []; const regx = isIntranet ? /^@ali\\/fie-(plugin|toolkit)-/ : /^fie-(plugin|toolkit)-/; const keyword = isIntranet ? '@ali/fie-' : 'fie-'; try { if (!moduleList.length) { const res = yield request(searchApi(keyword)); const body = JSON.parse(res.body); body.packages.forEach((item) =&gt; { if (regx.test(item.name)) { moduleList.push(item); } }); cache.set(utils.ONLINE_MODULE_CACHE_KEY, moduleList, { expries: 3600000 }); } } catch (e) { // 返回数据出错, 可能是没网 } log.debug(`get online list time ${Date.now() - start}`); moduleList = options.type ? utils.moduleFilter(moduleList, options.type) : moduleList; log.debug('所有线上模块: %o', moduleList); return moduleList; } module.exports = onlineList; × Search results Close "},"fie-core_commands_help.js.html":{"id":"fie-core_commands_help.js.html","title":"Source: fie-core/commands/help.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/commands/help.js /** * 查看FIE 及 套件的 帮助信息 */ 'use strict'; const fieConfig = require('fie-config'); const fieModule = require('fie-module'); const fieEnv = require('fie-env'); const chalk = require('chalk'); const tips = fieEnv.isIntranet() ? '阿里内网环境' : '外网环境'; const help = ` fie 使用帮助: $ fie [command] [options] $ fie 显示fie帮助信息,若目录下有使用的套件,则会同时显示套件的帮助信息 $ fie init [toolkitName] 初始化套件 $ fie update [name] 更新插件 $ fie install [name] 安装插件 $ fie list [type] 插件列表 $ fie uninstall [name] 安装删除插件 $ fie clear 清空 fie 的本地缓存 $ fie switch 切换 fie 的开发环境 $ fie help 显示套件帮助信息 $ fie [name] 其他调用插件命令 Options: -h, --help 显示fie帮助信息 -v, --version 显示fie版本 `; /** * 显示FIE帮助 */ function outFieHelpInfo(needToolkit) { // 打印帮助信息 console.log(chalk.cyan(help)); console.log(chalk.yellow(' 提示: ')); needToolkit &amp;&amp; console.log(chalk.yellow(' 套件 - 若想查看项目中所使用的套件帮助信息,请在项目根目录执行该命令.')); console.log(chalk.yellow(' 插件 - 若想查看插件的帮助信息,请使用 fie [name] help 命令, eg : fie git help')); console.log(chalk.yellow(` 环境 - 当前FIE开发环境为: ${tips} , 可使用 $ fie switch 进行切换`)); } module.exports = function* () { const toolkit = fieConfig.getToolkitName(); // 套件存在,则优先输出套件帮助信息 if (toolkit) { const moduleInfo = yield fieModule.get(fieModule.toolkitFullName(toolkit)); if (moduleInfo &amp;&amp; moduleInfo.mod &amp;&amp; moduleInfo.mod.help) { moduleInfo.mod.help(); console.log(chalk.cyan(' ------- 以下是 fie 自身的命令 ------- ')); } outFieHelpInfo(); } else { outFieHelpInfo(true); } }; × Search results Close "},"fie-module_lib_utils.js.html":{"id":"fie-module_lib_utils.js.html","title":"Source: fie-module/lib/utils.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-module/lib/utils.js 'use strict'; const env = require('fie-env'); const isIntranet = env.isIntranet(); /** * 获取套件模块完整名字 * @param name * @returns {string} */ function toolkitFullName(name) { let full = ''; name = name.replace('@ali/', ''); if (name.indexOf('fie-toolkit') === 0) { full = name; } else if (name.indexOf('toolkit') === 0) { full = `fie-${name}`; } else { full = `fie-toolkit-${name}`; } return isIntranet ? `@ali/${full}` : full; } /** * 获取插件模块完整名字 * @returns {string} */ function pluginFullName(name) { let full = ''; name = name.replace('@ali/', ''); if (name.indexOf('fie-plugin') === 0) { full = name; } else if (name.indexOf('plugin') === 0) { full = `fie-${name}`; } else { full = `fie-plugin-${name}`; } return isIntranet ? `@ali/${full}` : full; } const utils = { moduleFilter(list, type) { return list.filter(item =&gt; item.name.indexOf(`${type}-`) &gt; -1); }, /** * 根据传入的插件名称缩写,获取模块名称 * @param name * @returns {*} */ fullName(name) { if (name.indexOf('plugin-') &gt; -1) { return pluginFullName(name); } else if (name.indexOf('toolkit-') &gt; -1) { return toolkitFullName(name); } return name; }, pluginFullName, toolkitFullName, UPDATE_CHECK_PRE: 'fieModuleCheck_', ONLINE_MODULE_CACHE_KEY: 'onlineModuleList' }; module.exports = utils; × Search results Close "},"fie-core_lib_index.js.html":{"id":"fie-core_lib_index.js.html","title":"Source: fie-core/lib/index.js","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Source: fie-core/lib/index.js /** * fie 对外接口 */ 'use strict'; const co = require('co'); const home = require('fie-home'); const log = require('fie-log')('fie-core'); const fieError = require('fie-error'); const compatible = require('./compatible'); const api = require('./api'); const initEnv = require('./init-env'); /** * * @param argv tj/commandar.js 实例 * @param command fie所需的命令 * @param args 数组 fie命令所需的参数 */ function run(command, args) { co(function* () { // fie核心命令 const core = ['init', 'list', 'install', 'uninstall', 'update', 'version', 'help', 'clear', 'ii', 'switch']; // fie 家目录存在性检查 home.initHomeDir(); // 检测环境是否已初始化 yield initEnv(); // fie版本更新提示 yield compatible.updateTip(); if (core.indexOf(command) === -1) { // node环境判断, 小于4.x 就退出 compatible.checkNode(); const runner = require('../commands/all'); yield runner.apply(this, [command, args]); } else { // init, install, install, uninstall, update ,version 等命令 // 对 fie.config.js 没有依赖, 也不考虑兼容旧版, 也不执行自定义命令流 yield require(`../commands/${command}`).apply(null, [args]); } // 捕获异常 process.on('uncaughtException', (err) =&gt; { log.debug(`进入未知错误${JSON.stringify(err)}`); fieError.handle(err); }); }).catch((err) =&gt; { fieError.handle(err); }); } module.exports = { run }; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Global Members &lt;constant&gt; fieNpm Source: fie-core/commands/ii.js, line 3 &lt;constant&gt; fiePkg Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-core/commands/version.js, line 5 &lt;constant&gt; globby Created by hugo on 16/11/20. Source: fie-module/lib/local-list.js, line 6 &lt;constant&gt; log Created by hugo on 16/11/16. Source: fie-error/lib/handle-enoent.js, line 6 &lt;constant&gt; log Created by hugo on 16/11/16. Source: fie-error/lib/handle-module-not-found.js, line 6 Methods getCommonData(force) 获取上报所需的通用参数 Parameters: Name Type Description force 为 true时, 对 tnpm, node 版本等重新获取,一般在报错的时候才传入 true Source: fie-report/lib/index.js, line 53 Returns: Type string getPadding(str, width) 设置字符串边距 Parameters: Name Type Description str width Source: fie-core/commands/list.js, line 18 Returns: Type string getProjectEnv() 获取项目相关环境 Source: fie-report/lib/index.js, line 32 isGenerator(obj) 判断当前对象是否为 generator 对象 Parameters: Name Type Description obj Source: fie-task/lib/run-function.js, line 8 Returns: Type boolean isGeneratorFunction(obj) 判断当前对象是否为 generator 函数 Parameters: Name Type Description obj Source: fie-task/lib/run-function.js, line 17 Returns: Type boolean localExist() 模块是否存在 Source: fie-module/lib/local-exist.js, line 11 oneTask(task, args, hookParam) 运行单个任务 Parameters: Name Type Description task args hookParam Source: fie-task/lib/run.js, line 18 Returns: 是否继续往下执行, 为 false 的话,不继续执行,后面进程直接退出 Type boolean onlineExist() 模块是否存在 Source: fie-module/lib/online-exist.js, line 13 onlineList() 获取列表, 缓存机制 Source: fie-module/lib/online-list.js, line 22 Returns: Type * | Request | Array outFieHelpInfo() 显示FIE帮助 Source: fie-core/commands/help.js, line 39 pluginFullName() 获取插件模块完整名字 Source: fie-module/lib/utils.js, line 30 Returns: Type string run(options) 运行任务 Parameters: Name Type Description options Source: fie-task/lib/run.js, line 98 run(argv, command, args) Parameters: Name Type Description argv tj/commandar.js 实例 command fie所需的命令 args 数组 fie命令所需的参数 Source: fie-core/lib/index.js, line 20 runFunction() 执行某个函数 如果是 generator 类型,则使用 yield执行, 并在其后执行 next(0) 否则普通调用, 并传入 next 函数 Parameters: Name Type Description options.method function 函数体 options.args array 参数 options.next function 下一步执行方法 Source: fie-task/lib/run-function.js, line 33 Returns: 函数体内的返回值 Type mix runPlugin(name, cliArgs, next) 运行插件命令 Parameters: Name Type Description name cliArgs next Source: fie-core/commands/all.js, line 26 toolkitFullName(name) 获取套件模块完整名字 Parameters: Name Type Description name Source: fie-module/lib/utils.js, line 12 Returns: Type string userInfoGetter() 调用时再用git 生成用户信息,尽量减少无用执行 Source: fie-report/lib/index.js, line 23 × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Modules Namespaces fie-cache fie-config fie-env fie-error fie-fs fie-fs fie-home fie-log fie-report fie-user × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespaces Namespaces fie-cache fie-config fie-env fie-error fie-fs fie-fs fie-home fie-log fie-report fie-user × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter fie FIE (Fronend Integrated Environment), 前端统一集成开发环境. 主要解决问题 快速初始化项目模板及环境 加速项目开发 沉淀团队技术 使用及套件/插件开发请见官网 fie.alibaba.net FIE核心开发clone 代码项目到本地git clone git@gitlab.alibaba-inc.com:fie/fie.git创建软链从fie项目根目录到全局的 npm 的 bin 目录# 进入git clone下来的fie 项目根目录，执行npm link, 如要提示要权限，前面加sudo npm link修改代码执行完上面的步骤之后 ,现在你在本机任何目录运行的 fie xxx 命令都将执行你当前项目目录下的代码,你可以轻松的进行调试和修改. 调试代码安装调试工具 $ tnpm install node-inspector -g启动调试 $ node-debug /path/to/fie/bin/fie [commands]查看 debug 输出通过调用命令时传入 DEBUG=fie 可以查看 fie 核心打印的一些调试信息,用于快速定位错误原因 $ DEBUG=fie node /path/to/fie/bin/fie [commands]可以结合 node-debug 一起使用, 在调试套件,插件时也可以在 DEBUG 中传入多个值,使用英文逗号分隔, 具体可以查看debug模块 测试执行单元测试$ npm test编写单元测试在 test 目录下，建立与需要测试的模块对应的文件结构进行测试，主要使用 mocha、chai、sinon 及 proxyrequire 等工具进行测试。 × Search results Close "},"fie-cache.html":{"id":"fie-cache.html","title":"Namespace: fie-cache","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-cache fie-cache 缓存模块 Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-cache/lib/index.js, line 1 See: http://fie.alibaba.net/doc?package=fie-cache × Search results Close "},"fie-config.html":{"id":"fie-config.html","title":"Namespace: fie-config","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-config fie-config fie配置文件(fie.config.js)读写等操作 Source: fie-config/lib/index.js, line 1 See: ttp://fie.alibaba.net/doc?package=fie-config × Search results Close "},"fie-env.html":{"id":"fie-env.html","title":"Namespace: fie-env","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-env fie-env FIE的内外网环境获取与设置 Author: 宇果 &lt;baofen14787@gmail.com&gt; Source: fie-env/lib/index.js, line 3 Requires module:fie-env × Search results Close "},"fie-error.html":{"id":"fie-error.html","title":"Namespace: fie-error","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-error fie-error 异常处理中心,扑获常见的异常 并人性化展示 Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-error/lib/index.js, line 1 Requires module:fie-error/handle module:fie-error/register × Search results Close "},"fie-error.module_handle.html":{"id":"fie-error.module_handle.html","title":"Module: handle","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: handle 错误处理,先会调用之前注册过的错误处理,最后执行默认的处理 Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-error/lib/handle.js, line 1 Methods &lt;inner&gt; handle(e) 注册错误处理器 Parameters: Name Type Description e error 错误对象 Source: fie-error/lib/handle.js, line 25 × Search results Close "},"fie-error.module_register.html":{"id":"fie-error.module_register.html","title":"Module: register","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: register 注册错误处理器 Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-error/lib/register.js, line 1 Methods &lt;inner&gt; register(handle) 注册错误处理器 Parameters: Name Type Description handle generatorFunction | Array 错误处理器, 必须是 generator函数, 多个时可以传数组,进程报错时传入错误对象并依次调用,如果 catch 到错误并处理完请返回 true, 否则将继续往下执行其他处理器函数 Source: fie-error/lib/register.js, line 19 × Search results Close "},"fie-fs.html":{"id":"fie-fs.html","title":"Namespace: fie-fs","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-fs fie-fs 汇集文件操作的基本方法 Author: 擎空 &lt;zernmal@foxmail.com&gt; Source: fie-fs/lib/index.js, line 1 See: http://fie.alibaba.net/doc?package=fie-fs Requires module:fie-fs/copy-director module:fie-fs/copy-tpl module:fie-fs/rewrite-fie module:fie-fs/remove module:fie-fs/move Namespace: fie-fs fie-fs 汇集系统操作基本方法 Author: 擎空 &lt;qingkong@alibaba-inc.com&gt; Source: fie-task/lib/index.js, line 1 See: http://fie.alibaba.net/doc?package=fie-home Requires module:fie-task/run module:fie-task/funFunction × Search results Close "},"fie-fs.module_copy-directory.html":{"id":"fie-fs.module_copy-directory.html","title":"Module: copy-directory","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: copy-directory copy file Author: 擎空 &lt;qingkong@alibaba-inc.com&gt; Source: fie-fs/lib/copy-directory.js, line 1 See: http://fie.alibaba.net/doc?package=fie-home Requires module:@ali/fie-logger module:underscore Methods &lt;inner&gt; copyDirectory(options) 复制目录支持 underscore 模板引擎, 标签开始和结束符是: &lt;{% %}&gt; Parameters: Name Type Description options object Properties Name Type Description src string 绝对路径 dist string 绝对路径 data string ignore array 数组, 类似 gitignore 的写法 Source: fie-fs/lib/copy-directory.js, line 45 Example options.src 绝对路径 options.dist 绝对路径 options.data options.ignore 数组, 类似 gitignore 的写法 options.stringReplace 数组 , 将文件里面匹配到的字符串替换掉,如 [ { placeholder: 'PLACEHOLDER', value: 'theReplaceValue' } ] options.filenameTransformer 函数, 文件名转换函数列表 options.templateSettings 详细使用请查看 underscore 的templateSettings, 默认为: { evaluate: /&lt;{%([\\s\\S]+?)%}&gt;/g, interpolate: /&lt;{%=([\\s\\S]+?)%}&gt;/g, escape: /&lt;{%-([\\s\\S]+?)%}&gt;/g } options.encoding 默认 utf-8 × Search results Close "},"fie-fs.module_copy-tpl.html":{"id":"fie-fs.module_copy-tpl.html","title":"Module: copy-tpl","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: copy-tpl 复制文件 Author: 擎空 &lt;qingkong@alibaba-inc.com&gt; Source: fie-fs/lib/copy-tpl.js, line 1 Methods &lt;inner&gt; copyTpl(options) 复制文件支持 underscore 模板引擎, 标签开始和结束符是: &lt;{% %}&gt; Parameters: Name Type Description options object Source: fie-fs/lib/copy-tpl.js, line 31 × Search results Close "},"fie-fs.module_rewrite-file.html":{"id":"fie-fs.module_rewrite-file.html","title":"Module: rewrite-file","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: rewrite-file 重写文件内容, 本文件不提供读写文件能力,使用者自己读写文件(主要考虑一个文件需要多次被重写) Author: 擎空 &lt;qingkong@alibaba-inc.com&gt; Source: fie-fs/lib/rewrite-file.js, line 1 See: http://fie.alibaba.net/doc?package=fie-home Requires module:@ali/fie-logger Methods &lt;inner&gt; hookMatchStr(content, hookOptions) Hook a string Parameters: Name Type Description content string string to be hook hookOptions object Properties Name Type Description hook string 判断需要插入行的标记 insertLines array 数组类型, 每一项为新行 place string before / after(默认) noMatchActive string top / bottom / null(默认) Source: fie-fs/lib/rewrite-file.js, line 77 Returns: Type string &lt;inner&gt; rewriteFile(options) rewriteFile每次调用只能 match 一个hook Parameters: Name Type Description options object Properties Name Type Description src string 文件路径或内容 hook string 判断需要插入行的标记 insertLines array 数组类型, 每一项为新行 place string before / after(默认) noMatchActive string top / bottom / null(默认) srcMode number 0:src是文件路径(默认), 1:src 是文件内容 Source: fie-fs/lib/rewrite-file.js, line 27 Returns: Type string × Search results Close "},"fie-home.html":{"id":"fie-home.html","title":"Namespace: fie-home","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-home fie-home 获取fie及模块的相关路径，不建议插件直接对 fie 家目录里面的内容直接进行操作 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-home/lib/index.js, line 1 × Search results Close "},"fie-log.html":{"id":"fie-log.html","title":"Namespace: fie-log","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-log fie-log 获取fie及模块的相关路径，不建议插件直接对 fie 家目录里面的内容直接进行操作 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-log/lib/index.js, line 1 See: http://fie.alibaba.net/doc?package=fie-home × Search results Close "},"fie-report.html":{"id":"fie-report.html","title":"Namespace: fie-report","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-report fie-report 信息上报retcode Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/index.js, line 1 × Search results Close "},"fie-report.module_fie-report.html":{"id":"fie-report.module_fie-report.html","title":"Module: fie-report","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-report 配置retcode for node Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/conf-node.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object Module: fie-report 上报日志API Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/apis.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object Module: fie-report 上报日志核心方法 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/core.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object Module: fie-report http(s) 请求 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/request-node.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object Module: fie-report 抽样算法 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/sampling.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object Module: fie-report 上报日志入口(this.__WPO) Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-report/lib/retcode/log-node.js, line 1 Methods &lt;inner&gt; httpRequest(url) 发送http请求方法 Parameters: Name Type Description url string Source: fie-report/lib/retcode/request-node.js, line 18 Returns: Type void &lt;inner&gt; sampling(对象) 随机抽样算法 Parameters: Name Type Description 对象 Object Source: fie-report/lib/retcode/sampling.js, line 16 Returns: 对象原型附上sampling 方法 Type Object × Search results Close "},"fie-user.html":{"id":"fie-user.html","title":"Namespace: fie-user","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Namespace: fie-user fie-user 根据用户当前 git 信息去获取用户相关信息 Author: 六韬 &lt;yubhbh@gmail.com&gt; Source: fie-user/lib/index.js, line 1 See: http://fie.alibaba.net/doc?package=fie-user × Search results Close "},"module-fie-cache.html":{"id":"module-fie-cache.html","title":"Module: fie-cache","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-cache Source: fie-cache/lib/index.js, line 19 Methods &lt;static&gt; get(key) 获取缓存内容,如果不存在或已过期则返回 null Parameters: Name Type Description key string 缓存的键 Source: fie-cache/lib/index.js, line 25 Returns: Type mix &lt;static&gt; set(key, value, options) 设置缓存内容 Parameters: Name Type Description key string 缓存的键 value mix 缓存的值 options object Properties Name Type Description expries number 有效时长,毫秒为单位, 如 1分钟为 360000 Source: fie-cache/lib/index.js, line 46 Returns: Type boolean × Search results Close "},"module-fie-config.html":{"id":"module-fie-config.html","title":"Module: fie-config","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-config Source: fie-config/lib/index.js, line 98 × Search results Close "},"module-fie-env.html":{"id":"module-fie-env.html","title":"Module: fie-env","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-env Source: fie-env/lib/index.js, line 38 Members &lt;static&gt; setEnv 设置FIE的运行环境,设置成功后写入到FILE_ENV文件里 Source: fie-env/lib/index.js, line 44 Methods &lt;static&gt; hasConfigFile() 判断FIE环境配置文件(fie.env.json)是否存在可用做FIE环境是否已初始化的判断 Source: fie-env/lib/index.js, line 97 Returns: Type boolean &lt;static&gt; isIntranet() 是否是内网环境优先判断process.env.FIE_ENV变量,值为intranet,则返回true Source: fie-env/lib/index.js, line 66 Returns: 若是公司内网,则返回true,否则为false Type boolean &lt;static&gt; removeConfigFile() 删除FIE环境配置文件(fie.env.json) Source: fie-env/lib/index.js, line 105 &lt;static&gt; setExtranetEnv() 设置FIE的运行环境为外网环境 Source: fie-env/lib/index.js, line 50 &lt;static&gt; setIntranetEnv() 设置FIE的运行环境为内网环境 Source: fie-env/lib/index.js, line 57 × Search results Close "},"module-fie-home.html":{"id":"module-fie-home.html","title":"Module: fie-home","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-home Source: fie-home/lib/index.js, line 28 Methods &lt;static&gt; cleanHomeDir() 清理Home目录内容用户手工删除是没影响的，fie 会验证并初始化 Source: fie-home/lib/index.js, line 57 &lt;static&gt; getGlobalConfig(key) 获取FIE的全局配置文件 Parameters: Name Type Description key string 可选参数key Source: fie-home/lib/index.js, line 69 To Do: how to throw an excetion in fie-package ? Returns: .fie/pageckage.json 的json对象 Type object &lt;static&gt; getHomePath(key) 获取FIE的home路径 Parameters: Name Type Description key string 可选参数key Source: fie-home/lib/index.js, line 35 Returns: 返回路径字符串 Type string &lt;static&gt; getModulesPath() 获取FIE模块的安装路径 Source: fie-home/lib/index.js, line 41 Returns: 返回路径字符串 Type string &lt;static&gt; initHomeDir() 初始化FIE的home目录 Source: fie-home/lib/index.js, line 46 × Search results Close "},"module-fie-log.html":{"id":"module-fie-log.html","title":"Module: fie-log","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-log Source: fie-log/lib/index.js, line 16 × Search results Close "},"module-fie-report.html":{"id":"module-fie-report.html","title":"Module: fie-report","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-report Source: fie-report/lib/index.js, line 122 Methods &lt;static&gt; coreCommand(command) 根据核心命令发送日志(spmId: fie-core-command) Parameters: Name Type Description command string 命令串 Source: fie-report/lib/index.js, line 129 &lt;static&gt; error(type, error) 自定义retcode发送日志 (spmId: fie-error) Parameters: Name Type Description type string 错误类型 error object | string 信息 Source: fie-report/lib/index.js, line 159 &lt;static&gt; moduleUsage(command) 根据模块名称发送retcode日志(spmId: fie-module-use) Parameters: Name Type Description command string 命令串 Source: fie-report/lib/index.js, line 143 × Search results Close "},"module-fie-user.html":{"id":"module-fie-user.html","title":"Module: fie-user","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-user Source: fie-user/lib/index.js, line 16 Methods &lt;static&gt; getUser() 获取用户信息 Source: fie-user/lib/index.js, line 23 Returns: userInfo 返回用户信息 Type Object userInfo.name 用户名 Type string userInfo.email 用户Email Type string × Search results Close "},"module-fie-utils.html":{"id":"module-fie-utils.html","title":"Module: fie-utils","body":" 共享FIE Namespaces fie-cachefie-configfie-envfie-errorfie-fsfie-homefie-logfie-reportfie-user Modules fie-error.handlefie-error.registerfie-fs.copy-directoryfie-fs.copy-tplfie-fs.rewrite-filefie-report.fie-reportfie-cachefie-configfie-envfie-homefie-logfie-reportfie-userfie-utils Global fieNpmfiePkggetCommonDatagetPaddinggetProjectEnvglobbyisGeneratorisGeneratorFunctionlocalExistlogoneTaskonlineExistonlineListoutFieHelpInfopluginFullNamerunrunFunctionrunPlugintoolkitFullNameuserInfoGetter Module: fie-utils Source: fie-utils/lib/index.js, line 7 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
